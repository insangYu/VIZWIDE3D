let SHWebSocket=function(a,b){let c=this,d='',e;this['IsConnected']=![];let f=undefined,g,h=[],i=0x0,j=0x0,k='',l=[];m();function m(){d='ws://localhost:8989/';}this['PlayerSocket']=function(){let A={'ID':-0x1,'name':'','avatarID':-0x1,'avatarUUID':undefined,'fileDataID':undefined,'position':new b['Vector3'](),'zAngle':0x0,'TrgPosition':new b['Vector3'](),'TrgZAngle':0x0,'MoveOffset':new b['Vector3'](),'chat':'','review':undefined};return A;};function n(){if(!c['IsConnected'])return;let A=new ArrayBuffer(0x100),B=new DataView(A),C=0x0,D=0xa;{B['setInt8'](C,D,!![]),C+=0x1;}{let E=r(g['name']),F=E['length'];B['setInt8'](C,F,!![]),C+=0x1;for(let G=0x0;G<F;G++){B['setUint8'](C,E[G]),C++;}}e['send'](B);}function o(){if(!c['IsConnected'])return;if(g===undefined)return;if(a['Control']['GetMode']()!==b['Enum']['CONTROL_STATE']['WALKTHROUGH'])return;let A=a['Avatar']['GetObject']();if(A===undefined)return;if(A['direction']['length']()===0x0)return;let B=new ArrayBuffer(0x20),C=0x0,D=0x0,E=new DataView(B),F=new Uint16Array(B),G=0x14;{E['setInt8'](C,G,!![]),C+=0x1;}{E['setInt8'](C,g['avatarID'],!![]),C+=0x1;}{g['position']['copy'](A['position']),g['zAngle']=A['direction']['get2DAngle'](),E['setFloat32'](C,g['position']['x'],!![]),C+=0x4,E['setFloat32'](C,g['position']['y'],!![]),C+=0x4,E['setFloat32'](C,g['position']['z'],!![]),C+=0x4,E['setFloat32'](C,g['zAngle'],!![]),C+=0x4;}e['send'](E);}function p(A){let B=new ArrayBuffer(0x100),C=0x0,D=0x0,E=new DataView(B),F=new Uint16Array(B),G=0x1e;{E['setInt8'](C,G,!![]),C+=0x1;}{let H=r(A),I=H['length'];E['setInt8'](C,I,!![]),C+=0x1;for(let J=0x0;J<I;J++){E['setUint8'](C,H[J]),C++;}}e['send'](E);}function q(A){let B=r(A),C=0x1+0x2+B['length'],D=new ArrayBuffer(C),E=0x0,F=0x0,G=new DataView(D),H=0x32;{G['setInt8'](E,H,!![]),E+=0x1;}{let I=r(A),J=I['length'];G['setInt16'](E,J,!![]),E+=0x2;for(let K=0x0;K<J;K++){G['setUint8'](E,I[K]),E++;}}e['send'](G);}function r(A){let B=[];for(let C=0x0;C<A['length'];C++){let D=A['charCodeAt'](C);if(D<0x80)B['push'](D);else{if(D<0x800)B['push'](0xc0|D>>0x6,0x80|D&0x3f);else D<0xd800||D>=0xe000?B['push'](0xe0|D>>0xc,0x80|D>>0x6&0x3f,0x80|D&0x3f):(C++,D=(D&0x3ff)<<0xa|A['charCodeAt'](C)&0x3ff,B['push'](0xf0|D>>0x12,0x80|D>>0xc&0x3f,0x80|D>>0x6&0x3f,0x80|D&0x3f));}}return B;}function s(A,B,C){let D='';for(let E=0x0,F;E<C;){F=A['getUint8'](B+E++),D+=String['fromCharCode'](F>0xdf&&F<0xf0&&E<C-0x1?(F&0xf)<<0xc|(A['getUint8'](B+E++)&0x3f)<<0x6|A['getUint8'](B+E++)&0x3f:F>0x7f&&E<C?(F&0x1f)<<0x6|A['getUint8'](B+E++)&0x3f:F);}return D;}function t(A){c['IsConnected']=!![],console['log']('CONNECTED');}function u(A){c['IsConnected']=![],console['log']('DISCONNECTED');}this['Connected']=function(A,B){if(B!==undefined)c['SetPlayer'](B);if(A===undefined)A=d;d=A,e=new WebSocket(d),e['onopen']=function(C){t(C);},e['onclose']=function(C){u(C);},e['onmessage']=function(C){w(C);},e['onerror']=function(C){x(C);};},this['Disconnected']=function(){if(e===undefined)return;if(!IsConnected)return;e['close']();if(f!==undefined)clearInterval(f);f=undefined;},this['SetPlayer']=function(A){if(c['IsConnected'])return;g=A;},this['UpdatePlayerState']=function(A,B){if(g===undefined)return;g['position']['copy'](A),g['zAngle']=B;},this['UpdatePlayerChatBoxPos']=function(A){if(g===undefined)return;g['review']!==undefined&&(g['review']['text']['position']['copy'](A),g['review']['text']['position']['z']+=0x7d0);},this['UpdatePlayerAvatar']=function(A,B){if(g===undefined)return;for(let C=0x0;C<h['length'];C++){if(h[C]['fileDataID']===undefined)continue;if(h[C]['fileDataID']['localeCompare'](A)!==0x0)continue;h[C]['avatarUUID']=B;break;}},this['GetPlayerDataByAvatar']=function(A){for(let B=0x0;B<h['length'];B++){if(h[B]['avatarUUID']===undefined)continue;if(h[B]['avatarUUID']['localeCompare'](A)!==0x0)continue;return h[B];}return undefined;},this['SetChat']=function(A){q(A);};let v=function(A,B){for(let C=0x0;C<B['length'];C++)A['push'](B[C]);};function w(A){let B=new FileReader();B['onload']=function(C){let D=B['result'],E=new DataView(D),F=E['getInt8'](0x0);if(F===0x1){g['ID']=E['getInt32'](0x1,!![]);if(g['review']===undefined){let G=a['Data']['ReviewItem']();G['itemType']=b['Enum']['REVIEW_TYPES']['RK_TOOLTIP_NOTE'],G['style']['border']['color']['set'](0xff,0xff,0xff,0xff),G['style']['background']['color']['set'](0xff,0xff,0xff,0xff),G['style']['line']['thickness']=0x1,G['style']['line']['color']['set'](0x29,0x8f,0xc2,0xff),G['text']['value']['length']=0x0,G['text']['position']=new b['Vector3'](),a['Data']['Reviews']['push'](G),g['review']=G;}console['log']('CONNECTED\x20ID\x20:\x20'+g['ID']),n(),f=setInterval(z,0x3e8);}if(F===0xb){let H=E['getInt32'](0x1,!![]),I=E['getInt8'](0x5,!![]),J=s(E,0x6,I),K=![];if(g['ID']===H)K=!![];for(let L=0x0;L<h['length'];L++){if(h[L]['ID']===H){h[L]['name']=J,K=!![];break;}}if(!K){let M=new c['PlayerSocket']();M['ID']=H,M['name']=J;let N=a['Data']['ReviewItem']();N['itemType']=b['Enum']['REVIEW_TYPES']['RK_TOOLTIP_NOTE'],N['style']['border']['color']['set'](0xff,0xff,0xff,0xff),N['style']['background']['color']['set'](0xff,0xff,0xff,0xff),N['style']['line']['thickness']=0x1,N['style']['line']['color']['set'](0x29,0x8f,0xc2,0xff),N['text']['value']['length']=0x0,N['text']['position']=new b['Vector3'](),a['Data']['Reviews']['push'](N),M['review']=N,h['push'](M);}}if(F===0xc){let O=E['getInt8'](0x1,!![]),P=0x2;for(let Q=0x0;Q<O;Q++){let R=E['getInt32'](P,!![]);P+=0x4;let S=E['getInt8'](P,!![]);P+=0x1;let T=s(E,P,S);P+=S;let U=new c['PlayerSocket']();U['ID']=R,U['name']=T;let V=a['Data']['ReviewItem']();V['itemType']=b['Enum']['REVIEW_TYPES']['RK_TOOLTIP_NOTE'],V['style']['border']['color']['set'](0xff,0xff,0xff,0xff),V['style']['background']['color']['set'](0xff,0xff,0xff,0xff),V['style']['line']['thickness']=0x1,V['style']['line']['color']['set'](0x29,0x8f,0xc2,0xff),V['text']['value']['length']=0x0,V['text']['position']=new b['Vector3'](),a['Data']['Reviews']['push'](V),U['review']=V,h['push'](U);}}if(F===0x15){let W=E['getInt8'](0x1,!![]),X=0x2;for(let Y=0x0;Y<W;Y++){let Z=E['getInt32'](X,!![]);X+=0x4;let a0=E['getInt8'](X,!![]);X++;let a1=E['getFloat32'](X,!![]);X+=0x4;let a2=E['getFloat32'](X,!![]);X+=0x4;let a3=E['getFloat32'](X,!![]);X+=0x4;let a4=E['getFloat32'](X,!![]);X+=0x4;for(let a5=0x0;a5<h['length'];a5++){if(h[a5]['ID']===Z){h[a5]['avatarID']=a0,h[a5]['TrgPosition']=new b['Vector3'](a1,a2,a3),h[a5]['TrgZAngle']=a4;if(h[a5]['fileDataID']===undefined){let a6=a['TestCustomFBX_Player'](h[a5]['avatarID']);h[a5]['fileDataID']=a6['ID'],a['CustomObject']['AddDownloadInitPosAndDirection'](h[a5]['fileDataID'],h[a5]['TrgPosition'],new b['Vector3'](Math['cos'](h[a5]['TrgZAngle']),Math['sin'](h[a5]['TrgZAngle']),0x0),new b['Vector3'](0x0,0x0,0x1)),h[a5]['position']['copy'](h[a5]['TrgPosition']),h[a5]['MoveOffset']=new b['Vector3'](0x0,0x0,0x0),h[a5]['review']['text']['position']=new b['Vector3']()['copy'](h[a5]['position']),h[a5]['review']['text']['position']['z']+=0x7d0;}else h[a5]['avatarUUID']===undefined?(a['CustomObject']['AddDownloadInitPosAndDirection'](h[a5]['fileDataID'],h[a5]['TrgPosition'],new b['Vector3'](Math['cos'](h[a5]['TrgZAngle']),Math['sin'](h[a5]['TrgZAngle']),0x0),new b['Vector3'](0x0,0x0,0x1)),h[a5]['position']['copy'](h[a5]['TrgPosition']),h[a5]['MoveOffset']=new b['Vector3'](0x0,0x0,0x0),h[a5]['review']['text']['position']=new b['Vector3']()['copy'](h[a5]['position']),h[a5]['review']['text']['position']['z']+=0x7d0):h[a5]['MoveOffset']=new b['Vector3']()['subVectors'](h[a5]['TrgPosition'],h[a5]['position']);break;}}}}if(F===0x1f){let a7=E['getInt32'](0x1,!![]),a8=E['getInt8'](0x5,!![]),a9=s(E,0x6,a8),aa='',ab=undefined;if(g['ID']===a7)aa=aa+g['name'],ab=g['review'];else for(let ac=0x0;ac<h['length'];ac++){if(h[ac]['ID']===a7){aa=aa+h[ac]['name'],ab=h[ac]['review'];break;}}ab!==undefined&&(ab['text']['value']['length']===0x0?ab['text']['value']['push'](aa+'\x20:\x20'+a9):ab['text']['value']['push'](a9),setTimeout(function(){ab['text']['value']['shift'](),ab['text']['value']['length']>0x0&&(ab['text']['value'][0x0]=aa+'\x20:\x20'+ab['text']['value'][0x0]);},0x1388));}if(F===0x29){let ad=E['getInt32'](0x1,!![]);for(let ae=0x0;ae<h['length'];ae++){if(h[ae]['ID']===ad){a['CustomObject']['DeleteObject'](h[ae]['avatarUUID']),a['Data']['DeleteReview'](h[ae]['reviewID']),h['splice'](ae,0x1);break;}}}if(F===0x33){let af=E['getInt32'](0x1,!![]),ag='';j=af,k='',l=[];{let ah=new ArrayBuffer(0x20),ai=new DataView(ah),aj=0x0,ak=0x34;{ai['setInt8'](aj,ak,!![]),aj+=0x1;}e['send'](ai);}}if(F===0x35||F===0x36){let al=E['getInt32'](0x1,!![]),am=E['getInt8'](0x5,!![]),an=s(E,0x6,am);if(F===0x35){k=k+an,l['push'](an);{let ao=new ArrayBuffer(0x20),ap=new DataView(ao),aq=0x0,ar=0x34;{ap['setInt8'](aq,ar,!![]),aq+=0x1;}e['send'](ap);}}if(F===0x36){let as='',at=undefined;if(g['ID']===al)as=as+g['name'],at=g['review'];else for(let au=0x0;au<h['length'];au++){if(h[au]['ID']===al){as=as+h[au]['name'],at=h[au]['review'];break;}}l['push'](an),l['length']>0x0&&(l[0x0]=as+'\x20:\x20'+l[0x0]),at!==undefined&&(at['text']['value']['length']===0x0?v(at['text']['value'],l):(at['text']['value']=[],v(at['text']['value'],l)),setTimeout(function(){at['text']['value']['length']>0x0&&(at['text']['value']=[]);},0x1388)),k=0x0,l=[],console['log']('Receive\x20:\x20채팅\x20메세지2\x20-\x20'+as);}}},B['readAsArrayBuffer'](A['data']),i=new Date()['getTime']();}function x(A){console['log'](A);}function y(A){e['send'](A);}function z(){o();}};export default SHWebSocket;