class Handle{constructor(a,b){let c=this,d;e();function e(){d=[];}this['Clear']=function(){e();},this['Handler']=function(){return d;},this['Add']=function(f){let g=a['Data']['HandlerItem']();return g['itemType']=f,d['push'](g),g;},this['GetHandle']=function(f){let g=undefined;for(let h=0x0;h<d['length'];h++){if(d[h]['id']!==f)continue;g=d[h];}return g;},this['Delete']=function(f){let g=-0x1;for(let h=0x0;h<d['length'];h++){if(d[h]['id']!==f)continue;g=h;break;}g>=0x0&&d['splice'](g,0x1);},this['ClearState']=function(){for(let f=0x0;f<d['length'];f++){let g=d[f];g['state']=b['Enum']['HANDLE_MOUSE_STATE']['NONE'],g['axis']['x']['select']=![],g['axis']['y']['select']=![],g['axis']['z']['select']=![],g['panel']['xy']['select']=![],g['panel']['yz']['select']=![],g['panel']['zx']['select']=![],g['rotate']['x']['select']=![],g['rotate']['y']['select']=![],g['rotate']['z']['select']=![],g['sphere']['select']=![];}},this['ClearStateById']=function(f){let g=a['Handle']['GetHandle'](f);if(g===undefined)return;g['state']=b['Enum']['HANDLE_MOUSE_STATE']['NONE'],g['axis']['x']['select']=![],g['axis']['y']['select']=![],g['axis']['z']['select']=![],g['panel']['xy']['select']=![],g['panel']['yz']['select']=![],g['panel']['zx']['select']=![],g['rotate']['x']['select']=![],g['rotate']['y']['select']=![],g['rotate']['z']['select']=![],g['sphere']['select']=![];},this['Visible']=function(f,g){let h=a['Handle']['GetHandle'](f);if(h===undefined)return;h['visible']=g;},this['Pick']=function(f,g){if(d['length']<=0x0)return undefined;for(let h=d['length']-0x1;h>=0x0;h--){let i=d[h];if(i['object']===undefined)continue;if(!i['enable'])continue;let j=c['PickItem'](i,f,g);if(j!==undefined)return j;}return undefined;},this['PickItem']=function(f,g,h){if(f['object']===undefined)return undefined;if(!f['enable'])return undefined;let j=new b['Matrix4']()['copy'](a['Camera']['matMV']);const k=new b['Matrix4']()['copy'](a['Camera']['matMVP']);j['setPosition'](new b['Vector3']());const l=0x5;let m=new b['Vector3'](g,h,0x0),n=new b['Vector3']()['copy'](f['center']),o=f['style']['length'],p=f['style']['radius'];{let E=new b['Vector3']()['copy'](f['center']),F=new b['Vector3']()['copy'](f['center'])['add'](new b['Vector3'](f['style']['length'],0x0,0x0)),G=new b['Vector3']()['copy'](f['center'])['add'](new b['Vector3'](f['style']['radius'],0x0,0x0));E=a['Camera']['world2ScreenWithMatrix'](k,E),F=new b['Vector3']()['copy'](E)['add'](new b['Vector3'](f['style']['length'],0x0,0x0)),G=new b['Vector3']()['copy'](E)['add'](new b['Vector3'](f['style']['radius'],0x0,0x0));let H=a['Camera']['screen2WorldWithMatrix'](k,F),I=a['Camera']['screen2WorldWithMatrix'](k,G);o=H['sub'](n)['length'](),p=I['sub'](n)['length']();}let q=new b['Vector3']()['copy'](f['axis']['x']['normal']),r=new b['Vector3']()['copy'](f['axis']['y']['normal']),s=new b['Vector3']()['copy'](f['axis']['z']['normal']);const t=o,u=o*1.2,v=p,w=p*1.5,z=o*0.3,A=p*2.5;let B=new b['Vector3']()['copy'](f['center']);B=a['Camera']['world2ScreenWithMatrix'](k,B),B['z']=0x0;if(f['axis']['x']['enable']){let J=new b['Vector3']()['addVectors'](n,new b['Vector3']()['copy'](q)['multiplyScalar'](u));J=a['Camera']['world2ScreenWithMatrix'](k,J),J['z']=0x0;if(a['Util']['Point2LineDistance'](m,B,J)<f['style']['radius']+l)return f['axis']['x']['select']=!![],f;}if(f['axis']['y']['enable']){let K=new b['Vector3']()['addVectors'](n,new b['Vector3']()['copy'](r)['multiplyScalar'](u));K=a['Camera']['world2ScreenWithMatrix'](k,K),K['z']=0x0;if(a['Util']['Point2LineDistance'](m,B,K)<f['style']['radius']+l)return f['axis']['y']['select']=!![],f;}if(f['axis']['z']['enable']){let L=new b['Vector3']()['addVectors'](n,new b['Vector3']()['copy'](s)['multiplyScalar'](u));L=a['Camera']['world2ScreenWithMatrix'](k,L),L['z']=0x0;if(a['Util']['Point2LineDistance'](m,B,L)<f['style']['radius']+l)return f['axis']['z']['select']=!![],f;}let C,D;{let M;if(a['Camera']['perspectiveView'])M=new b['Vector3'](g,h,0x0);else M=new b['Vector3'](g,h,-0x1);let N=new b['Vector3'](M['x'],M['y'],M['z']),O=new b['Vector3'](M['x'],M['y'],0x1);C=a['Camera']['screen2WorldWithMatrix'](a['Camera']['matMVP'],N),D=a['Camera']['screen2WorldWithMatrix'](a['Camera']['matMVP'],O);}if(f['panel']['xy']['enable']){let P=[],Q=[0x0,0x3,0x2,0x3,0x2,0x1];P[0x0]=new b['Vector3']()['addVectors'](n,new b['Vector3']()['copy'](q)['multiplyScalar'](z)),P[0x1]=new b['Vector3']()['addVectors'](n,new b['Vector3']()['copy'](r)['multiplyScalar'](z)),P[0x2]=new b['Vector3']()['addVectors'](n,new b['Vector3']()['addVectors'](new b['Vector3']()['copy'](q)['multiplyScalar'](z),new b['Vector3']()['copy'](r)['multiplyScalar'](z))),P[0x3]=new b['Vector3']()['copy'](n);for(let R=0x0;R<0x2;R++){let S=a['Util']['LineToTriangleIntersections'](C,D,P[Q[R*0x3+0x0]],P[Q[R*0x3+0x1]],P[Q[R*0x3+0x2]]);if(S[0x0]===0x1)return f['panel']['xy']['select']=!![],f;}}if(f['panel']['yz']['enable']){let T=[],U=[0x0,0x3,0x2,0x3,0x2,0x1];T[0x0]=new b['Vector3']()['addVectors'](n,new b['Vector3']()['copy'](r)['multiplyScalar'](z)),T[0x1]=new b['Vector3']()['addVectors'](n,new b['Vector3']()['copy'](s)['multiplyScalar'](z)),T[0x2]=new b['Vector3']()['addVectors'](n,new b['Vector3']()['addVectors'](new b['Vector3']()['copy'](r)['multiplyScalar'](z),new b['Vector3']()['copy'](s)['multiplyScalar'](z))),T[0x3]=new b['Vector3']()['copy'](n);for(let V=0x0;V<0x2;V++){let W=a['Util']['LineToTriangleIntersections'](C,D,T[U[V*0x3+0x0]],T[U[V*0x3+0x1]],T[U[V*0x3+0x2]]);if(W[0x0]===0x1)return f['panel']['yz']['select']=!![],f;}}if(f['panel']['zx']['enable']){let X=[],Y=[0x0,0x3,0x2,0x3,0x2,0x1];X[0x0]=new b['Vector3']()['addVectors'](n,new b['Vector3']()['copy'](s)['multiplyScalar'](z)),X[0x1]=new b['Vector3']()['addVectors'](n,new b['Vector3']()['copy'](q)['multiplyScalar'](z)),X[0x2]=new b['Vector3']()['addVectors'](n,new b['Vector3']()['addVectors'](new b['Vector3']()['copy'](s)['multiplyScalar'](z),new b['Vector3']()['copy'](q)['multiplyScalar'](z))),X[0x3]=new b['Vector3']()['copy'](n);for(let Z=0x0;Z<0x2;Z++){let a0=a['Util']['LineToTriangleIntersections'](C,D,X[Y[Z*0x3+0x0]],X[Y[Z*0x3+0x1]],X[Y[Z*0x3+0x2]]);if(a0[0x0]===0x1)return f['panel']['zx']['select']=!![],f;}}if(f['rotate']['x']['enable']){}if(f['rotate']['y']['enable']){}if(f['rotate']['z']['enable']){}if(f['sphere']['enable']){if(new b['Vector3'](g,h,0x0)['sub'](B)['length']()<f['style']['radius'])return f['sphere']['select']=!![],f;}return undefined;},this['UpdateTransformByMouseMove']=function(f,g,h,i,j){let k=g-i,l=h-j;if(k===0x0&&l===0x0)return;const m=new b['Matrix4']()['copy'](a['Camera']['matMVP']);let n=new b['Vector3']()['copy'](f['center']),o=a['Camera']['world2ScreenWithMatrix'](m,n),p=new b['Vector3'](o['x']+k,o['y']+l,o['z']),q=a['Camera']['screen2WorldWithMatrix'](m,p),r=new b['Vector3']()['subVectors'](q,f['center']),s=new b['Vector3']()['copy'](r)['length'](),t=new b['Vector3']()['copy'](r)['normalize'](),u=new b['Vector3']()['copy'](f['axis']['x']['normal']),v=new b['Vector3']()['copy'](f['axis']['y']['normal']),w=new b['Vector3']()['copy'](f['axis']['z']['normal']),z=new b['Matrix4']();if(f['axis']['x']['enable']&&f['axis']['x']['select']){let A=u['dot'](t),B=new b['Vector3']()['copy'](u);B['multiplyScalar'](s)['multiplyScalar'](A),f['center']['add'](B),z['makeTranslation'](B['x'],B['y'],B['z']);}else{if(f['axis']['y']['enable']&&f['axis']['y']['select']){let C=v['dot'](t),D=new b['Vector3']()['copy'](v);D['multiplyScalar'](s)['multiplyScalar'](C),f['center']['add'](D),z['makeTranslation'](D['x'],D['y'],D['z']);}else{if(f['axis']['z']['enable']&&f['axis']['z']['select']){let E=w['dot'](t),F=new b['Vector3']()['copy'](w);F['multiplyScalar'](s)['multiplyScalar'](E),f['center']['add'](F),z['makeTranslation'](F['x'],F['y'],F['z']);}else{if(f['panel']['xy']['enable']&&f['panel']['xy']['select']){let G=new b['Plane'](w,w['dot'](f['center'])),H=new b['Vector3'](),I=new b['Vector3']();G['projectPoint'](new b['Vector3']()['copy'](f['center']),H),G['projectPoint'](new b['Vector3']()['copy'](q),I);let J=new b['Vector3'](I['x']-H['x'],I['y']-H['y'],I['z']-H['z']);f['center']['add'](J),z['makeTranslation'](J['x'],J['y'],J['z']);}else{if(f['panel']['yz']['enable']&&f['panel']['yz']['select']){let K=new b['Plane'](u,u['dot'](f['center'])),L=new b['Vector3'](),M=new b['Vector3']();K['projectPoint'](new b['Vector3']()['copy'](f['center']),L),K['projectPoint'](new b['Vector3']()['copy'](q),M);let N=new b['Vector3'](M['x']-L['x'],M['y']-L['y'],M['z']-L['z']);f['center']['add'](N),z['makeTranslation'](N['x'],N['y'],N['z']);}else{if(f['panel']['zx']['enable']&&f['panel']['zx']['select']){let O=new b['Plane'](v,v['dot'](f['center'])),P=new b['Vector3'](),Q=new b['Vector3']();O['projectPoint'](new b['Vector3']()['copy'](f['center']),P),O['projectPoint'](new b['Vector3']()['copy'](q),Q);let R=new b['Vector3'](Q['x']-P['x'],Q['y']-P['y'],Q['z']-P['z']);f['center']['add'](R),z['makeTranslation'](R['x'],R['y'],R['z']);}}}}}}return z;},this['Render']=function(){if(a['Control']['GetMode']()!==b['Enum']['CONTROL_STATE']['NORMAL'])return;if(d['length']<=0x0)return;const f=new b['Matrix4']()['copy'](a['Camera']['matMVP']);a['Shader']['BeginShader'](b['Enum']['SHADER_TYPES']['BASIC2D']),a['Shader']['SetGLLight'](),a['Shader']['SetClipping'](undefined),a['Shader']['SetMatrix'](f,new b['Matrix4']());for(let g=0x0;g<d['length'];g++){if(!d[g]['enable'])continue;if(!d[g]['visible'])continue;if(d[g]['object']===undefined)continue;const h=d[g];c['RenderItem'](h);}a['Shader']['EndShader']();},this['RenderItem']=function(f){if(!f['enable'])return;if(!f['visible'])return;if(f['object']===undefined)return;let g=new b['Matrix4']()['copy'](a['Camera']['matMV']);const h=new b['Matrix4']()['copy'](a['Camera']['matMVP']);let i=new b['Vector3']()['copy'](f['center']),j=f['style']['length'],k=f['style']['radius'];{let u=new b['Vector3']()['copy'](f['center']),v=new b['Vector3']()['copy'](f['center'])['add'](new b['Vector3'](f['style']['length'],0x0,0x0)),w=new b['Vector3']()['copy'](f['center'])['add'](new b['Vector3'](f['style']['radius'],0x0,0x0));u=a['Camera']['world2ScreenWithMatrix'](h,u),v=new b['Vector3']()['copy'](u)['add'](new b['Vector3'](f['style']['length'],0x0,0x0)),w=new b['Vector3']()['copy'](u)['add'](new b['Vector3'](f['style']['radius'],0x0,0x0));let x=a['Camera']['screen2WorldWithMatrix'](h,v),y=a['Camera']['screen2WorldWithMatrix'](h,w);j=x['sub'](i)['length'](),k=y['sub'](i)['length']();}let l=new b['Vector3']()['copy'](f['axis']['x']['normal']),m=new b['Vector3']()['copy'](f['axis']['y']['normal']),n=new b['Vector3']()['copy'](f['axis']['z']['normal']);const o=j,p=j*1.2,q=k,r=k*1.5,s=j*0.3,t=k*2.5;{if(f['panel']['xy']['enable']){let z=new b['Color'](0x64,0x64,0xff,0x64);f['panel']['xy']['select']&&(z['r']+=0x50,z['g']+=0x50,z['a']+=0x64);let A=z['glColor']();a['Shader']['SetGLColor'](A['r'],A['g'],A['b'],A['a']);let B=new b['Vector3']()['addVectors'](i,new b['Vector3']()['copy'](l)['multiplyScalar'](s)),C=new b['Vector3']()['addVectors'](i,new b['Vector3']()['copy'](m)['multiplyScalar'](s)),D=new b['Vector3']()['addVectors'](i,new b['Vector3']()['addVectors'](new b['Vector3']()['copy'](l)['multiplyScalar'](s),new b['Vector3']()['copy'](m)['multiplyScalar'](s))),E=new b['Vector3']()['copy'](i);a['Renderer']['Util_DrawRectangle3D'](B,E,D,C);}if(f['panel']['yz']['enable']){let F=new b['Color'](0xff,0x0,0x0,0x64);f['panel']['yz']['select']&&(F['g']+=0x7f,F['b']+=0x7f,F['a']+=0x64);let G=F['glColor']();a['Shader']['SetGLColor'](G['r'],G['g'],G['b'],G['a']);let H=new b['Vector3']()['addVectors'](i,new b['Vector3']()['copy'](m)['multiplyScalar'](s)),I=new b['Vector3']()['addVectors'](i,new b['Vector3']()['copy'](n)['multiplyScalar'](s)),J=new b['Vector3']()['addVectors'](i,new b['Vector3']()['addVectors'](new b['Vector3']()['copy'](m)['multiplyScalar'](s),new b['Vector3']()['copy'](n)['multiplyScalar'](s))),K=new b['Vector3']()['copy'](i);a['Renderer']['Util_DrawRectangle3D'](H,K,J,I);}if(f['panel']['zx']['enable']){let L=new b['Color'](0x0,0xff,0x0,0x64);f['panel']['zx']['select']&&(L['r']+=0x7f,L['b']+=0x7f,L['a']+=0x64);let M=L['glColor']();a['Shader']['SetGLColor'](M['r'],M['g'],M['b'],M['a']);let N=new b['Vector3']()['addVectors'](i,new b['Vector3']()['copy'](n)['multiplyScalar'](s)),O=new b['Vector3']()['addVectors'](i,new b['Vector3']()['copy'](l)['multiplyScalar'](s)),P=new b['Vector3']()['addVectors'](i,new b['Vector3']()['addVectors'](new b['Vector3']()['copy'](n)['multiplyScalar'](s),new b['Vector3']()['copy'](l)['multiplyScalar'](s))),Q=new b['Vector3']()['copy'](i);a['Renderer']['Util_DrawRectangle3D'](N,Q,P,O);}}{if(f['axis']['x']['enable']){let R=new b['Color'](0xff,0x0,0x0,0xff);f['axis']['x']['select']&&(R['g']+=0x7f,R['b']+=0x7f);let S=R['glColor']();a['Shader']['SetGLColor'](S['r'],S['g'],S['b'],S['a']);let T=new b['Vector3']()['addVectors'](i,new b['Vector3']()['copy'](l)['multiplyScalar'](o)),U=new b['Vector3']()['addVectors'](i,new b['Vector3']()['copy'](l)['multiplyScalar'](p));a['Renderer']['Util_DrawCylinder3D'](i,T,q),a['Renderer']['Util_DrawCone3D'](T,U,r);}if(f['axis']['y']['enable']){let V=new b['Color'](0x0,0xff,0x0,0xff);f['axis']['y']['select']&&(V['r']+=0x7f,V['b']+=0x7f);let W=V['glColor']();a['Shader']['SetGLColor'](W['r'],W['g'],W['b'],W['a']);let X=new b['Vector3']()['addVectors'](i,new b['Vector3']()['copy'](m)['multiplyScalar'](o)),Y=new b['Vector3']()['addVectors'](i,new b['Vector3']()['copy'](m)['multiplyScalar'](p));a['Renderer']['Util_DrawCylinder3D'](i,X,q),a['Renderer']['Util_DrawCone3D'](X,Y,r);}if(f['axis']['z']['enable']){let Z=new b['Color'](0x64,0x64,0xff,0xff);f['axis']['z']['select']&&(Z['r']+=0x50,Z['g']+=0x50);let a0=Z['glColor']();a['Shader']['SetGLColor'](a0['r'],a0['g'],a0['b'],a0['a']);let a1=new b['Vector3']()['addVectors'](i,new b['Vector3']()['copy'](n)['multiplyScalar'](o)),a2=new b['Vector3']()['addVectors'](i,new b['Vector3']()['copy'](n)['multiplyScalar'](p));a['Renderer']['Util_DrawCylinder3D'](i,a1,q),a['Renderer']['Util_DrawCone3D'](a1,a2,r);}}{if(f['rotate']['x']['enable']){}if(f['rotate']['y']['enable']){}if(f['rotate']['z']['enable']){}}if(f['axis']['x']['enable']&&f['axis']['y']['enable']&&f['axis']['z']['enable']||f['sphere']['enable']){let a3=new b['Color'](0x7f,0x7f,0x7f,0xff);f['sphere']['select']&&(a3['r']+=0x50,a3['g']+=0x50,a3['b']+=0x50);let a4=a3['glColor']();a['Shader']['SetGLColor'](a4['r'],a4['g'],a4['b'],a4['a']),a['Renderer']['Util_DrawSphere3D'](i,t);}};}}export default Handle;