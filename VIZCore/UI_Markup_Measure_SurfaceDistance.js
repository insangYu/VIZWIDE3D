let UIMarkup_Measure_SurfaceDistance=function(a,b,c){let d=this;this['base']=c['UIMarkup_Base'],this['base'](a,b);let e=-0x1,f=undefined,g=new c['BBox'](),h=new c['Vector3'](),i=undefined;this['Start']=function(){if($('.ui_message')['length']>0x0){let j='Measure\x20the\x20coordinates\x20of\x20a\x20particular\x20point.',k=j;$('.ui_message_text')['html'](k),$('.ui_message')['fadeIn'](0x1f4);}d['base']['prototype']['Start']['call'](d);},this['Release']=function(){e=-0x1,f=undefined,i=undefined,d['base']['prototype']['Release']['call'](d);},this['PreviousStep']=function(){switch(a['GetStep']()){case 0x1:{b['Data']['DeleteReview'](a['currentReviewItem']['id']),b['Renderer']['Render'](),d['mouseAction']=!![];}break;}},this['ProcessStep']=function(j){switch(a['GetStep']()){case 0x0:{if(j===undefined)return;if(!j['pick'])return;if(!j['surface'])return;a['currentReviewItem']['drawitem']['position'][0x0]=j['position'],h=j['normal'];let k=b['Data']['GetTriangles']([j['body']]);f=b['Data']['GetSurfaceTriangles'](j['triangle'],k),g=b['Util']['GetTrianglesBBox'](f),e=j['body']['bodyId'],b['Renderer']['Render'](),a['NextStep']();}break;case 0x1:{if(j===undefined)return;if(!j['pick'])return;if(!j['surface'])return;let l=j['normal']['dot'](h);if(Math['abs'](l)>0.999){let n=new c['Plane']()['setFromNormalAndCoplanarPoint'](h,a['currentReviewItem']['drawitem']['position'][0x0]),o=n['distanceToPoint'](j['position']),p=new c['Vector3']()['addVectors'](a['currentReviewItem']['drawitem']['position'][0x0],new c['Vector3']()['copy'](h)['multiplyScalar'](o));a['currentReviewItem']['drawitem']['position'][0x1]=p;}else{let q=b['Data']['GetTriangles']([j['body']]);i=b['Data']['GetSurfaceTriangles'](j['triangle'],q);let r=new c['Vector3'](),s=new c['Vector3']();b['Data']['GetMinDistanceByTriangles'](f,i,r,s),a['currentReviewItem']['drawitem']['position'][0x0]=r,a['currentReviewItem']['drawitem']['position'][0x1]=s;}let m=[a['currentReviewItem']['drawitem']['position'][0x0],a['currentReviewItem']['drawitem']['position'][0x1]];a['currentReviewItem']['itemType']=c['Enum']['REVIEW_TYPES']['RK_MEASURE_SURFACEDISTANCE'],b['Measure']['UpdateReviewStyle'](a['currentReviewItem']),b['Measure']['UpdateReviewText'](a['currentReviewItem'],m),a['currentReviewItem']['text']['position']=new c['Vector3']()['copy'](j['position']),b['Data']['Reviews']['push'](a['currentReviewItem']),b['Renderer']['Render'](),a['NextStep']();}break;case 0x2:{a['currentReviewItem']=undefined,b['Control']['RestoreMode'](),b['Renderer']['Render']();}break;}},this['mouseDown']=function(j,k,l){switch(a['GetStep']()){case 0x2:{d['mouseAction']=![],a['actionEnabled']=![];}break;}return a['base']['prototype']['mouseDown']['call'](a,j,k,l),a['actionEnabled']=!![],!![];},this['mouseMove']=function(j,k){a['base']['prototype']['mouseMove']['call'](a,j,k);switch(a['GetStep']()){case 0x2:{let l=new c['Matrix4']()['multiplyMatrices'](b['Camera']['projectionMatrix'],b['Camera']['cameraMatrix']),m=b['Camera']['world2ScreenWithMatrix'](l,new c['Vector3']()['copy'](a['currentReviewItem']['text']['position'])),n=b['Camera']['screen2WorldWithMatrix'](l,new c['Vector3'](j,k,m['z']));a['currentReviewItem']['text']['position']['copy'](n),b['Renderer']['Render']();}break;}},this['mouseUp']=function(j,k,l){a['actionEnabled']=![],a['base']['prototype']['mouseUp']['call'](a,j,k,l),a['actionEnabled']=!![];if(l===0x0&&a['GetMouseClick'](a['mouse']['x'],a['mouse']['y']))switch(a['GetStep']()){case 0x0:{let m=b['Renderer']['Picking'](a['mouse']['x'],a['mouse']['y']);m!==undefined&&(b['Data']['GetPickByBodyCacheDownload'](a['mouse']['x'],a['mouse']['y'],d['ProcessStep']),d['mouseAction']=![]);}break;case 0x1:{let n=b['Renderer']['Picking'](a['mouse']['x'],a['mouse']['y']);n!==undefined&&(b['Data']['GetPickByBodyCacheDownload'](a['mouse']['x'],a['mouse']['y'],d['ProcessStep']),d['mouseAction']=![]);}break;case 0x2:{d['ProcessStep']();}break;}else b['MeshBlock']['Reset']();return d['mouseAction'];},this['mouseWheel']=function(j,k,l){a['GetStep']()!==0x2&&a['base']['prototype']['mouseWheel']['call'](a,j,k,l);},this['Render']=function(){switch(a['GetStep']()){case 0x1:{let k=new c['Color'](0x64,0xff,0x0,0xff),l=new c['Color'](0x64,0xc8,0x0,0xff);b['Shader']['BeginShader'](c['Enum']['SHADER_TYPES']['PHONG']),b['Shader']['SetGLLight'](),b['Shader']['SetClipping'](undefined),b['gl']['enable'](b['gl']['DEPTH_TEST']),b['RenderWGL']['UpdateRenderProcessByTriangles'](f,k),b['Shader']['EndShader'](),b['gl']['disable'](b['gl']['DEPTH_TEST']);{b['Shader']['BeginShader'](c['Enum']['SHADER_TYPES']['BASIC2D']),b['Shader']['SetMatrix'](b['Camera']['matMVP'],b['Camera']['matMV']),b['Shader']['SetClipping'](undefined);let m=l,n=m['glColor']();b['Shader']['SetGLColor'](n['r'],n['g'],n['b'],n['a']);let o=[[0x0,0x4,0x4,0x5,0x5,0x1,0x1,0x0],[0x2,0x6,0x6,0x7,0x7,0x3,0x3,0x2],[0x0,0x2],[0x4,0x6],[0x1,0x3],[0x5,0x7]],p=b['Util']['GetBBox2Vertex'](g),q=b['gl']['createBuffer'](),r=[];b['gl']['bindBuffer'](b['gl']['ARRAY_BUFFER'],q),b['gl']['vertexAttribPointer'](b['Shader']['positionAttributeLocation'],0x3,b['gl']['FLOAT'],![],0x0,0x0);{let s=0x0;for(let t=0x0;t<o['length'];t++){for(let u=0x0;u<o[t]['length'];u++){r[s]=p[o[t][u]]['x'],s++,r[s]=p[o[t][u]]['y'],s++,r[s]=p[o[t][u]]['z'],s++;}}}b['gl']['bufferData'](b['gl']['ARRAY_BUFFER'],new Float32Array(r),b['gl']['STATIC_DRAW']),b['gl']['drawArrays'](b['gl']['LINES'],0x0,r['length']),b['gl']['deleteBuffer'](q);}b['Shader']['EndShader']();}break;}},this['Render2D']=function(j){const k=new c['Matrix4']()['copy'](b['Camera']['matMV']),l=new c['Matrix4']()['copy'](b['Camera']['matMVP']);switch(a['GetStep']()){case 0x0:break;case 0x1:{let m=0x3;j['fillStyle']='rgba(0,\x20255,\x200,\x201)';let n=b['Renderer']['Util_GetScreenPositionByMatrix'](l,a['currentReviewItem']['drawitem']['position'][0x0]);j['beginPath'](),j['arc'](n['x'],n['y'],m,0x0,Math['PI']*0x2),j['fill']();}break;case 0x2:break;default:break;}};};export default UIMarkup_Measure_SurfaceDistance;