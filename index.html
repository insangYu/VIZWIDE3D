<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>VIZWide3D :: SOFTHILLS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <link rel="stylesheet" href="VIZCore/Resource/css/VIZCore.css">
    <!--<link rel="stylesheet" href="VIZCore/Resource/css/VIZCore_dual.css">-->
    <script type="module">
        import VIZWide3D from "./VIZCore/VIZCore.js";
        import { VIZCore } from "./VIZCore/VIZCore.js";

        let view = document.getElementById("view");
        view.className = "VIZCore";

		//LJJ
		 view.style.left = "15%";   //view_info 사이즈 만큼 제외
        view.style.width = "85%";   //view_info 사이즈 만큼 제외
        
        let view_info = document.getElementById("view_info");
        view_info.style.display = "block";

        let view_Btn = document.getElementById("view_Button");
        view_Btn.style.left = "0";   //좌측
        view_Btn.style.width = "15%";   //좌측
        view_Btn.style.display = "block";

        let loadMultiModel = 0;
        let loadFileIdx = 0;

		let openModel_NBL_AREA4 = function() {
            loadMultiModel = 0;
            vizwide3d.Model.OpenHeader("./VIZCore/Model/AREA4/AREA4.NWC_wh.vizw");
			};

		let openModel_OMSK1 = function() {
            loadMultiModel = 0;
            vizwide3d.Model.OpenHeader("./VIZCore/Model/OMSK/VIEW1/VIEW1_wh.vizw");
			};

		let openModel_OMSK2 = function() {
            loadMultiModel = 0;
            vizwide3d.Model.OpenHeader("./VIZCore/Model/OMSK/VIEW2/VIEW2_wh.vizw");
			};


		//사용자 UI 설정
        {
			//#region 모델열기
            let view_BtnOffset = 0;

            let divCtrl = document.createElement('div');
            divCtrl.id = "VIZCore_Daelim_control";
            divCtrl.className = "ui_VIZCore_Daelim_control";

            view_Btn.appendChild(divCtrl);
       
            let btnModelOpen_NBL_AREA4 = document.createElement('div');
            btnModelOpen_NBL_AREA4.id = divCtrl.id + "btnModelOpen_NBL_AREA4";
            btnModelOpen_NBL_AREA4.className = "ui_button_large";
            btnModelOpen_NBL_AREA4.innerHTML = "AREA4 모델";
            btnModelOpen_NBL_AREA4.style.margin = "4px";            
            
            divCtrl.appendChild(btnModelOpen_NBL_AREA4);

            $("#" +divCtrl.id + "btnModelOpen_NBL_AREA4").on('click', function() {
                openModel_NBL_AREA4();
            });

			let btnModelOpen_OMSK1 = document.createElement('div');
            btnModelOpen_OMSK1.id = divCtrl.id + "btnModelOpen_OMSK1";
            btnModelOpen_OMSK1.className = "ui_button_large";
            btnModelOpen_OMSK1.innerHTML = "OMSK I";
            btnModelOpen_OMSK1.style.margin = "4px";            
            
            divCtrl.appendChild(btnModelOpen_OMSK1);

            $("#" +divCtrl.id + "btnModelOpen_OMSK1").on('click', function() {
                openModel_OMSK1();
            });

			let btnModelOpen_OMSK2 = document.createElement('div');
            btnModelOpen_OMSK2.id = divCtrl.id + "btnModelOpen_OMSK2";
            btnModelOpen_OMSK2.className = "ui_button_large";
            btnModelOpen_OMSK2.innerHTML = "OMSK II";
            btnModelOpen_OMSK2.style.margin = "4px";            
            
            divCtrl.appendChild(btnModelOpen_OMSK2);

            $("#" +divCtrl.id + "btnModelOpen_OMSK2").on('click', function() {
                openModel_OMSK2();
            });

			let btnModelClose = document.createElement('div');
            btnModelClose.id = divCtrl.id + "btnModelClose";
            btnModelClose.className = "ui_button_large";
            btnModelClose.innerHTML = "모델 닫기";
            btnModelClose.style.margin = "4px";
            divCtrl.appendChild(btnModelClose);

            $("#" + divCtrl.id + "btnModelClose").on('click', function() {
                vizwide3d.Model.Close();
            });
		}
		//LJJ

        let vizwide3d = new VIZWide3D(view);
        //console.log("import - call");
        let initresult = vizwide3d.Init();

        let onSelectEvent = function (event) {
            // 선택된 모델이 없음
            if (event.data.id == -1) {
                //alert('선택된 모델이 없거나, 기존 선택상태가 해제됨.');
            }
            // 선택된 모델이 있음
            else {
                console.log(event.data.id);
                //alert("MODEL NAME : " + event.data.name);
                let keys =[];
                keys = vizwide3d.Object3D.UDA.GetKeys();
                console.log(keys);
            }
        }
        

        let onLoadingCompleted = function (event) {
            //console.log("Load_Completed!");
        }

        let onEmptyMeshBlock = function (event) {
            console.log("Alert_EmptyMeshBlock!");
        }

        if (initresult === true) {
            // Toolbar 사용
            let toolbar = new vizwide3d.Toolbar(view, vizwide3d, VIZCore);
            // Add Event Handler : Loading Completed Event (로딩 완료 이벤트)
            vizwide3d.Model.OnModelOpenedEvent(onLoadingCompleted);

            vizwide3d.Model.OnStreamProgressChangedEvent(function(e){
                console.log("Total : ",  e.data.total, "Current : ", e.data.current, "Percentage : ", e.data.percentage);
            });

            // Add Event Handler : Object Selected Event (모델 선택 이벤트)
            vizwide3d.Object3D.OnObject3DSelected(onSelectEvent);
            vizwide3d.View.OnEmptyMeshBlockEvent(onEmptyMeshBlock);
        }

        // Init.
        vizwide3d.Model.OpenHeader("./VIZCore/Model/AREA4/AREA4.NWC_wh.vizw");

    </script>
</head>
<body>
    <div id="view"></div>
    <div id="viewDual"></div>
    <div id="view_info" class="view_info"></div>
	<div id="view_Button" class="view_info"></div>
</body>
</html>